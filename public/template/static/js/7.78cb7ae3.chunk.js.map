{"version":3,"sources":["assets/css/login.module.css","pages/Login.js"],"names":["module","exports","Login","state","username","password","errorMess","login","a","params","URLSearchParams","append","axios","url","method","data","res","err","window","localStorage","setItem","qs","stringify","path","parse","props","location","search","ignoreQueryPrefix","includes","history","push","pathname","setState","msg","changeIpt","ev","target","name","value","this","className","styles","content","arrow","borderWidth","bgColor","to","inputox","label","model","onChange","type","footbox","errcol","style","marginTop","marginBottom","background","border","clickHandler","Component"],"mappings":"2EACAA,EAAOC,QAAU,CAAC,QAAU,uBAAuB,YAAY,yBAAyB,OAAS,sBAAsB,MAAQ,uB,kOCQ1GC,E,4MAEjBC,MAAM,CACFC,SAAS,GACTC,SAAS,GACTC,UAAU,I,EAGdC,M,sBAAM,gCAAAC,EAAA,6DAEEC,EAAS,IAAIC,iBACVC,OAAO,WAAW,EAAKR,MAAMC,UACpCK,EAAOE,OAAO,WAAW,EAAKR,MAAME,UAJlC,SAMc,EAAKO,MAAM,CACvBC,IAAI,aACJC,OAAO,OACPC,KAAKN,IATP,OAYiB,KANfO,EANF,QAYMD,KAAKE,KAUTC,OAAOC,aAAaC,QAAQ,OAAOC,IAAGC,UAAUN,EAAID,QAEhDQ,EAAOF,IAAGG,MAAM,EAAKC,MAAMC,SAASC,OAAO,CAACC,mBAAkB,IAAOL,QAE5DA,EAAKM,SAAS,UACvB,EAAKJ,MAAMK,QAAQC,KAAK,CACpBC,SAASX,IAAGG,MAAM,EAAKC,MAAMC,SAASC,OAAO,CAACC,mBAAkB,IAAOL,OAG3E,EAAKE,MAAMK,QAAQC,KAAK,UAG5B,EAAKE,SAAS,CAAC3B,UAAUU,EAAID,KAAKmB,MAlCpC,2C,EAsCNC,UAAU,SAACC,GACP,EAAKH,SAAL,eACKG,EAAGC,OAAOC,KAAMF,EAAGC,OAAOE,S,uDAI1B,IAAD,EACgCC,KAAKrC,MAApCC,EADD,EACCA,SAASC,EADV,EACUA,SAASC,EADnB,EACmBA,UACvB,OACI,yBAAKmC,UAAWC,IAAOC,SACnB,kBAAC,IAAD,CAAOC,MAAM,OAAOC,YAAa,EAAGC,QAAQ,gBAC5C,oEACA,yBAAKL,UAAWC,IAAO,cAAvB,yDAEI,kBAAC,IAAD,CAAMK,GAAG,QAAT,6BAEJ,yBAAKN,UAAWC,IAAOM,SACnB,kBAAC,IAAD,CAEIC,MAAM,eAAKC,MAAO,CAACZ,KAAK,WAAWC,MAAMnC,EAAS+C,SAASX,KAAKL,aACpE,kBAAC,IAAD,CACIc,MAAM,eAENG,KAAK,WACLF,MAAO,CAACZ,KAAK,WAAWC,MAAMlC,EAAS8C,SAASX,KAAKL,cAG7D,yBAAKM,UAAWC,IAAOW,SACnB,6BAAK,6BACL,uBAAGZ,UAAWC,IAAOY,QAAShD,GAC9B,kBAAC,IAAD,CAAUiD,MAAO,CAACC,UAAU,UAAUC,aAAa,SAASC,WAAW,YAAYC,OAAO,QAASC,aAAcpB,KAAKjC,OAAtH,gBAGA,6BACA,uBAAGkC,UAAU,SAAb,wC,GAhFeoB","file":"static/js/7.78cb7ae3.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"content\":\"login_content__78ojh\",\"login-box\":\"login_login-box__3YlKM\",\"errcol\":\"login_errcol__2uTPP\",\"tishi\":\"login_tishi__3uZmc\"};","import React,{Component} from 'react';\r\nimport styles from '../assets/css/login.module.css'\r\nimport UcNav from \"../components/uc-nav/UcNav\";\r\nimport UcButton from \"../components/uc-button\";\r\n\r\nimport {Link} from 'react-router-dom'\r\nimport UcInput from \"../components/uc-input\";\r\n\r\nimport qs from 'qs';\r\nexport default class Login extends Component{\r\n\r\n    state={\r\n        username:'',\r\n        password:'',\r\n        errorMess:''\r\n    };\r\n\r\n    login=async ()=>{\r\n\r\n        let params = new URLSearchParams();\r\n        params.append(\"username\",this.state.username);\r\n        params.append(\"password\",this.state.password);\r\n\r\n        let res = await this.axios({\r\n            url:'/api/login',\r\n            method:'post',\r\n            data:params\r\n        });\r\n\r\n        if (res.data.err===0){\r\n            //更新同步localStrage\r\n            // window.localStorage.setItem(\"user\",qs.stringify(res.data));\r\n            // console.log('login 页面-- 登录成功')\r\n            // //跳转到之前\r\n            // this.props.history.push({\r\n            //     pathname:qs.parse(this.props.location.search,{ignoreQueryPrefix:true}).path\r\n            // })\r\n\r\n            //更新同步localStrage\r\n            window.localStorage.setItem(\"user\",qs.stringify(res.data));\r\n            //跳转到之前\r\n            let path = qs.parse(this.props.location.search,{ignoreQueryPrefix:true}).path;\r\n\r\n            if (path && !path.includes('/login')){\r\n                this.props.history.push({\r\n                    pathname:qs.parse(this.props.location.search,{ignoreQueryPrefix:true}).path\r\n                })\r\n            } else {\r\n                this.props.history.push('/user')\r\n            }\r\n        } else {\r\n            this.setState({errorMess:res.data.msg})\r\n        }\r\n    };\r\n\r\n    changeIpt=(ev)=>{\r\n        this.setState({\r\n            [ev.target.name]:ev.target.value\r\n        })\r\n    };\r\n\r\n    render(){\r\n        let {username,password,errorMess} = this.state;\r\n        return (\r\n            <div className={styles.content}>\r\n                <UcNav arrow=\"gray\" borderWidth={0} bgColor=\"transparent\" />\r\n                <h1>亲，欢迎登陆</h1>\r\n                <div className={styles['login-box']}>\r\n                    没有可使用的账户？\r\n                    <Link to=\"/reg\">立即注册</Link>\r\n                </div>\r\n                <div className={styles.inputox}>\r\n                    <UcInput\r\n                        // style={{textIndent: '0.2rem'}}\r\n                        label=\"用户\" model={{name:'username',value:username,onChange:this.changeIpt}}/>\r\n                    <UcInput\r\n                        label=\"密码\"\r\n                        // style={{textIndent: '0.2rem',}}\r\n                        type=\"password\"\r\n                        model={{name:'password',value:password,onChange:this.changeIpt}}\r\n                    />\r\n                </div>\r\n                <div className={styles.footbox}>\r\n                    <br/><br/>\r\n                    <p className={styles.errcol}>{errorMess}</p>\r\n                    <UcButton style={{marginTop:'0.64rem',marginBottom:'0.3rem',background:'indianred',border:'none'}} clickHandler={this.login}>登录</UcButton>\r\n                    {/*<UcButton clickHandler={this.show.bind(null,1,2,3)}>登录录</UcButton>*/}\r\n                    {/*<UcButton clickHandler={(ev)=>this.show(1,2,3,ev)}>登录录</UcButton>*/}\r\n                    <br/>\r\n                    <a className=\"tishi\">忘记密码？</a>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n }\r\n"],"sourceRoot":""}